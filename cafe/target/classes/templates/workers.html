<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Працівники</title>
    <link rel="stylesheet" th:href="@{/css/workers.css}" type="text/css">
</head>
<body>
<div class="workers-container">
    <!-- Ссылка на графики работы -->
    <a th:href="'/api/v1/apps/work-schedule-management/' + ${institutionId}" class="action-button">Графіки роботи працівників</a>

    <h2>Зареєструвати працівника</h2>
    <form action="/api/v1/apps/sign-up-worker" method="post" class="worker-form">
        <div>
            <label for="lastName">Прізвище:</label>
            <input type="text" name="lastName" id="lastName" required />
        </div>
        <div>
            <label for="firstName">Ім'я:</label>
            <input type="text" name="firstName" id="firstName" required />
        </div>
        <div>
            <label for="email">Email:</label>
            <input type="email" name="email" id="email" required />
        </div>
        <div>
            <label for="phone">Телефон:</label>
            <input type="text" name="phone" id="phone" required />
        </div>
        <div>
            <label for="password">Пароль:</label>
            <input type="password" name="password" id="password" required />
        </div>
        <div th:if="${currentUserRole} == 'ROLE_ADMIN'">
            <label for="roleId2">Роль:</label>
            <select id="roleId2" name="role.id">
                <option th:each="role : ${roles}" th:value="${role.id}" th:text="${role.name}" th:if="${role.id == 1 OR role.id == 2}"></option>
            </select>
        </div>
        <input type="hidden" name="role.id" value="5" th:if="${currentUserRole} == 'ROLE_OWNER'" />
        <input type="hidden" name="institutionId" th:value="${institutionId}" />
        <button type="submit" class="action-button">Зареєструвати</button>
    </form>

    <h2>Список працівників</h2>
    <div th:if="${workers != null}">
        <table class="workers-table">
            <thead>
            <tr>
                <th>Ім'я</th>
                <th>Прізвище</th>
                <th>Телефон</th>
                <th>Роль</th>
                <th>Оновити роль</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="worker : ${workers}">
                <td th:text="${worker.firstName}">Ім'я</td>
                <td th:text="${worker.lastName}">Прізвище</td>
                <td th:text="${worker.phone}">Телефон</td>
                <td th:text="${worker.role.id}">Роль</td>
                <td>
                    <form action="/api/v1/apps/update/role" method="post" class="role-update-form">
                        <input type="hidden" name="workerId" th:value="${worker.id}" />
                        <input type="hidden" name="institutionId" th:value="${institutionId}" />
                        <input type="number" id="roleId" name="roleId" placeholder="Новое значение" required />
                        <button type="submit" class="action-button">Оновити</button>
                    </form>
                </td>
            </tr>
            </tbody>
        </table>
    </div>

    <!-- Если работников нет -->
    <div th:if="${workers == null || workers.size() == 0}" class="no-workers-message">
        <p>Працівники відсутні.</p>
    </div>
</div>
</body>
</html>