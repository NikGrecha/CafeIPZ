<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Меню</title>
    <link rel="stylesheet" th:href="@{/css/menu.css}" type="text/css">
</head>
<body>
<div class="menu-container">
    <div th:if="${currentUserRole} == 'ROLE_COOK'" class="add-dish-form">
        <h2>Создать новое блюдо</h2>
        <form action="/api/v1/apps/dishes/save" method="post">
            <label for="title">Название:</label>
            <input type="text" id="title" name="title" required>

            <label for="descriptions">Описание:</label>
            <input type="text" id="descriptions" name="descriptions" required>

            <label for="recipe">Рецепт:</label>
            <input type="text" id="recipe" name="recipe">

            <label for="price">Цена:</label>
            <input type="number" id="price" name="price" required>

            <label for="institution">Заведение:</label>
            <select id="institution" name="institution">
                <option th:each="institution : ${institutions}" th:value="${institution.id}" th:text="${institution.name}"></option>
            </select>
            <button type="submit">Создать</button>
        </form>
    </div>

    <h2>Меню</h2>
    <form action="/api/v1/apps/new-order" method="post" class="order-form">
    <ul class="dish-list">
        <li class="dish-item" th:each="dish, index : ${dishes}">
            <div class="dish-details">
                <input type="hidden" th:name="dishId" id="dish" th:value="${dish.id}">
                <span class="dish-title" th:text="${dish.title}">Название</span>
                <p class="dish-description" th:text="${dish.descriptions}">Описание</p>
                <span class="dish-price">Цена: <span th:text="${dish.price}">0</span> грн</span>
                <span class="dish-institution" th:text="'Заведение: ' + ${dish.institutionId}">Заведение</span>
            </div>
            <div class="dish-actions">
                <input type="number" name="countDish" id="countDish" required value="0">
                <button type="submit"
                        th:if="${currentUserRole} == 'ROLE_CLIENT' and (${dish.userClientId} == null or ${dish.userClientId} != ${currentUserId})"
                        th:attr="onclick=|addFavorite('${institutionId}', '${dish.id}', '${currentUserId}', '${index}')|">
                    Добавить в избранное
                </button>
                <button type="button" th:unless="${dish.userClientId} == null or ${dish.userClientId} != ${currentUserId}">
                    В избранном
                </button>
            </div>
        </li>
    </ul>
    <h2>Создать заказ</h2>
        <div class="order-form-group">
            <label for="user" th:if="${currentUserRole} == 'ROLE_WAITER'">Выберите клиента:</label>
            <select id="user" name="userClientId" th:if="${currentUserRole} == 'ROLE_WAITER'">
                <option th:each="user : ${users}" th:value="${user.id}" th:text="${user.id} + ' ' + ${user.firstName} + ' ' + ${user.lastName}"></option>
            </select>
            <input type="hidden" name="userClientId" id="userClientId" th:unless="${currentUserRole} == 'ROLE_WAITER'" th:value="${currentUserId}">
        </div>

        <div class="order-form-group">
            <label for="wishes">Пожелания:</label>
            <input type="text" id="wishes" name="wishes">
        </div>

        <input type="hidden" id="institutionId" name="institutionId" th:value="${institutionId}">
        <input type="hidden" id="reserveId" name="reserveId" th:value="${param.reserveId}" th:if="${param.reserveId}">

        <button type="submit">Создать заказ</button>
    </form>
    <h2>Блюдо дня</h2>
    <div class="dish-of-day">
        <h3 th:text="${dishOfTheDay.title}">Название</h3>
        <p th:text="${dishOfTheDay.descriptions}">Описание</p>
        <span th:text="'Цена: ' + ${dishOfTheDay.price} + ' грн'">Цена</span>
        <span th:text="'Рецепт: ' + ${dishOfTheDay.recipe}">Рецепт</span>
    </div>
</div>
</body>
</html>